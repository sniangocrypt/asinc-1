import requests
import asyncio
from aiohttp import ClientSession
from collections import OrderedDict
import time
import random
import json
import aiofiles

dict = ["BTC", "ETH", "SOL"]
#symbol = f"BTC"


async def get_okx_info():
    async with ClientSession() as session:
        url = f'https://www.okx.com/api/v5/market/tickers?instType=SPOT'
        headers = {
            'Accept': 'application/json',
        }
        async with session.get(url=url, headers=headers) as response:
            data = await response.json()
    async with aiofiles.open('okxbook.json', 'w') as file:
        await file.write(json.dumps(data, indent=4))
    with open('okxbook.json', 'r') as file:
        data = json.load(file)
        okx = []
        for ticker in data['data']:
            if ticker['instId'][-5:] == "-USDT":
                okx.append(ticker)
                print(okx)










#get_order_book(symbol=f"ETH")

print("Start Time:", time.strftime('%X'))
asyncio.run(get_okx_info())
print("End Time:", time.strftime('%X'))
